(function(){app.modals.CreateOrEditEditionModal=function(){var n,r=abp.services.app.edition,t=null,i;this.init=function(r){function c(){u.find("#EditEdition_ExpireAction_AssignEdition").is(":checked")?e.slideDown("fast"):e.slideUp("fast")}function l(){u.find("#EditEdition_IsPaid").is(":checked")?(f.slideDown("fast"),h.slideDown("fast"),f.find("input").attr("required",!0)):(f.slideUp("fast"),h.slideUp("fast"),f.find("input").attr("required",!1))}function a(){u.find("#EditEdition_IsTrialActive").is(":checked")?o.slideDown("fast"):o.slideUp("fast")}function v(){u.find("#EditEdition_IsWaitingDayActive").is(":checked")?s.slideDown("fast"):s.slideUp("fast")}function w(){var n={radixPoint:".",groupSeparator:",",digits:2,autoGroup:!0,prefix:"$ ",rightAlign:!1,showMaskOnHover:!1,showMaskOnFocus:!1,placeholder:"_",removeMaskOnSubmit:!0,autoUnmask:!0};y.inputmask("numeric",$.extend({},n));p.inputmask("numeric",$.extend({},n))}var u;n=r;u=n.getModal();i=new FeaturesTree;i.init(u.find(".feature-tree"));var e=u.find(".edition-list"),f=u.find(".SubscriptionPrice"),o=u.find(".trial-day-count"),s=u.find(".waiting-day-after-expire"),h=u.find(".paid-features"),y=u.find('.paid-features > .SubscriptionPrice input[name="MonthlyPrice"]'),p=u.find('.paid-features > .SubscriptionPrice input[name="AnnualPrice"]');u.find("input[name=ExpireAction]").change(function(){c()});u.find("input[name=SubscriptionPrice]").change(function(){l()});u.find("#EditEdition_IsTrialActive").change(function(){a()});u.find("#EditEdition_IsWaitingDayActive").change(function(){v()});c();l();a();v();w();t=n.getModal().find("form[name=EditionInformationsForm]");t.validate()};this.save=function(){if(t.valid()){if(!i.isValid()){abp.message.warn(app.localize("InvalidFeaturesWarning"));return}var u=t.serializeFormToObject();n.setBusy(!0);r.createOrUpdateEdition({edition:u,featureValues:i.getFeatureValues()}).done(function(){abp.notify.info(app.localize("SavedSuccessfully"));n.close();abp.event.trigger("app.createOrEditEditionModalSaved")}).always(function(){n.setBusy(!1)})}}}})();