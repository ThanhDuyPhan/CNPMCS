(function(n){app.modals.CreateOrEditUserModal=function(){function u(){var i=[];return t.getModal().find(".user-role-checkbox-list input[type=checkbox]").each(function(){n(this).is(":checked")&&i.push(n(this).attr("name"))}),i}var f=abp.services.app.user,t,i=null,e=new app.PasswordComplexityHelper,r;this.init=function(f){t=f;r=new OrganizationTree;r.init(t.getModal().find(".organization-tree"));i=t.getModal().find("form[name=UserInformationsForm]");i.validate();var o=t.getModal().find("input[name=Password],input[name=PasswordRepeat]"),s=o.closest(".form-group");e.setPasswordComplexityRules(o,window.passwordComplexitySetting);n("#EditUser_SetRandomPassword").change(function(){n(this).is(":checked")?(s.slideUp("fast"),t.getArgs().id||o.removeAttr("required")):(s.slideDown("fast"),t.getArgs().id||o.attr("required","required"))});t.getModal().find(".user-role-checkbox-list input[type=checkbox]").change(function(){n("#assigned-role-count").text(u().length)});t.getModal().find("[data-toggle=tooltip]").tooltip()};this.save=function(){if(i.valid()){var e=u(),n=i.serializeFormToObject();n.SetRandomPassword&&(n.Password=null);t.setBusy(!0);f.createOrUpdateUser({user:n,assignedRoleNames:e,sendActivationEmail:n.SendActivationEmail,SetRandomPassword:n.SetRandomPassword,organizationUnits:r.getSelectedOrganizations()}).done(function(){abp.notify.info(app.localize("SavedSuccessfully"));t.close();abp.event.trigger("app.createOrEditUserModalSaved")}).always(function(){t.setBusy(!1)})}}}})(jQuery);