(function(){$(function(){var n=abp.services.app.tenantDashboard,t={daily:1,weekly:2,monthly:3},i=function(n,t,i,r){$("#totalProfit").text(n);$("#newFeedbacks").text(t);$("#newOrders").text(i);$("#newUsers").text(r)},r=function(t,i,r,u,f){var o=function(t){var i=function(n){return new Morris.Area({element:t,padding:0,behaveLikeLine:!1,gridEnabled:!1,gridLineColor:!1,axes:!1,fillOpacity:1,data:n,lineColors:["#399a8c","#92e9dc"],xkey:"period",ykeys:["sales","profit"],labels:["Sales","Profit"],pointSize:0,lineWidth:0,hideHover:"auto",resize:!0})},r=function(t){var i=this;n.getSalesSummary({salesSummaryDatePeriod:t}).done(function(n){i.graph.setData(n.salesSummary);i.graph.redraw()})},u=function(n){this.graph?(this.graph.setData(n),this.graph.redraw()):this.graph=i(n)};return{draw:u,refresh:r,graph:null}},e;$("#salesStatistics").show();e=new o("salesStatistics");e.draw(t);$("input[name='SalesSummaryDateInterval'").change(function(){e.refresh(this.value)});$("#totalSales").text(i);$("#revenue").text(r);$("#expenses").text(u);$("#growth").text(f);$("#salesStatisticsLoading").hide()},u=function(t,i,r){var u=function(n,t,i){$("#transactionPercent").attr("data-percent",n);$("#transactionPercent span").text(n);$("#newVisitPercent").attr("data-percent",t);$("#newVisitPercent span").text(t);$("#bouncePercent").attr("data-percent",i);$("#bouncePercent span").text(i);$(".easy-pie-chart-loading").hide()},f=function(n,t,i){$("#transactionPercent").data("easyPieChart").update(n);$("#transactionPercent span").text(n);$("#newVisitPercent").data("easyPieChart").update(t);$("#newVisitPercent span").text(t);$("#bouncePercent").data("easyPieChart").update(i);$("#bouncePercent span").text(i)},e=function(){$(".easy-pie-chart .number.transactions").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:"#ffb822"});$(".easy-pie-chart .number.visits").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:"#36a3f7"});$(".easy-pie-chart .number.bounce").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:"#f4516c"})};$("#generalStatsReload").click(function(){n.getGeneralStats({}).done(function(n){f(n.transactionPercent,n.newVisitPercent,n.bouncePercent)})});u(t,i,r);e()},f=function(n){for(var u,i,f,r=[],t=1;t<=n.length;t++)r.push("Day "+t);(u={labels:r,datasets:[{backgroundColor:mUtil.getColor("success"),data:n},{backgroundColor:"#f3f3fb",data:n}]},i=$("#m_chart_daily_sales"),i.length!==0)&&(f=new Chart(i,{type:"bar",data:u,options:{title:{display:!1},tooltips:{intersect:!1,mode:"nearest",xPadding:10,yPadding:10,caretPadding:10},legend:{display:!1},responsive:!0,maintainAspectRatio:!1,barRadius:4,scales:{xAxes:[{display:!1,gridLines:!1,stacked:!0}],yAxes:[{display:!1,stacked:!0,gridLines:!1}]},layout:{padding:{left:0,right:0,top:0,bottom:0}}}}))},e=function(){_initSparklineChart=function(n,t,i,r){if(n.length!==0){var u={type:"line",data:{labels:["January","February","March","April","May","June","July","August","September","October"],datasets:[{label:"",borderColor:i,borderWidth:r,pointHoverRadius:4,pointHoverBorderWidth:12,pointBackgroundColor:Chart.helpers.color("#000000").alpha(0).rgbString(),pointBorderColor:Chart.helpers.color("#000000").alpha(0).rgbString(),pointHoverBackgroundColor:mUtil.getColor("danger"),pointHoverBorderColor:Chart.helpers.color("#000000").alpha(.1).rgbString(),fill:!1,data:t}]},options:{title:{display:!1},tooltips:{enabled:!1,intersect:!1,mode:"nearest",xPadding:10,yPadding:10,caretPadding:10},legend:{display:!1,labels:{usePointStyle:!1}},responsive:!0,maintainAspectRatio:!0,hover:{mode:"index"},scales:{xAxes:[{display:!1,gridLines:!1,scaleLabel:{display:!0,labelString:"Month"}}],yAxes:[{display:!1,gridLines:!1,scaleLabel:{display:!0,labelString:"Value"},ticks:{beginAtZero:!0}}]},elements:{point:{radius:4,borderWidth:12}},layout:{padding:{left:0,right:10,top:5,bottom:0}}}};return new Chart(n,u)}};var t=function(){n.getRegionalStats({}).done(function(n){for(var i,f,e,u,t,o,s=$("#region_statistics_content table tbody"),r=0;r<n.stats.length;r++)i=n.stats[r],f=$("<tr><\/tr>").append($('<td class="m-datatable__cell--center m-datatable__cell m-datatable__cell--check"><span style="width: 40px;"><label class="m-checkbox m-checkbox--solid m-checkbox--single m-checkbox--brand" style="margin-bottom:-18px;"><input type = "checkbox" > <span><\/span><\/label><\/span><\/td>'),$("<td>"+i.countryName+"<\/td>"),$("<td>$"+i.sales.toFixed(2)+"<\/td>"),$('<td><div class="m-widget11__chart" style="height:50px; width: 100px"><iframe class="chartjs-hidden-iframe" tabindex="-1" style="display: block; overflow: hidden; border: 0px; margin: 0px; top: 0px; left: 0px; bottom: 0px; right: 0px; height: 100%; width: 100%; position: absolute; pointer-events: none; z-index: -1;"><\/iframe><canvas class="m_chart_sales_by_region" style="display: block; width: 100px; height: 50px;" width="100" height="50"><\/canvas><\/div><\/td>'),$("<td>$"+i.averagePrice.toFixed(2)+"<\/td>"),$("<td>$"+i.totalPrice.toFixed(2)+"<\/td>")),s.append(f);for(e=["accent","danger","success","warning"],u=$("canvas.m_chart_sales_by_region"),t=0;t<u.length;t++)o=u[t],self._initSparklineChart(o,n.stats[t].change,mUtil.getColor(e[t%4]),2)})};t()},o=function(n){var i=$("#m_chart_profit_share"),t,r;if(i.length!==0){t=i.closest(".m-widget14").find(".m-widget14__legend-text");$(t[0]).text(n[0]+"% Product Sales");$(t[1]).text(n[1]+"% Online Courses");$(t[2]).text(n[2]+"% Custom Development");r=new Chartist.Pie("#m_chart_profit_share",{series:[{value:n[0],className:"custom",meta:{color:mUtil.getColor("brand")}},{value:n[1],className:"custom",meta:{color:mUtil.getColor("accent")}},{value:n[2],className:"custom",meta:{color:mUtil.getColor("warning")}}],labels:[1,2,3]},{donut:!0,donutWidth:17,showLabel:!1});r.on("draw",function(n){var t,i;n.type==="slice"&&(t=n.element._node.getTotalLength(),n.element.attr({"stroke-dasharray":t+"px "+t+"px"}),i={"stroke-dashoffset":{id:"anim"+n.index,dur:1e3,from:-t+"px",to:"0px",easing:Chartist.Svg.Easing.easeOutQuint,fill:"freeze",stroke:n.meta.color}},n.index!==0&&(i["stroke-dashoffset"].begin="anim"+(n.index-1)+".end"),n.element.attr({"stroke-dashoffset":-t+"px",stroke:n.meta.color}),n.element.animate(i,!1))})}},s=function(){var t=function(){n.getMemberActivity({}).done(function(n){$("#memberActivityTable tbody>tr").each(function(t){var i=$(this).find("td"),r=$("<a/>").attr("href","javascript:;").addClass("primary-link").text(n.memberActivities[t].name);$(i[1]).empty().append(r);$(i[2]).html(n.memberActivities[t].cases);$(i[3]).html(n.memberActivities[t].closed);$(i[4]).html(n.memberActivities[t].rate);$(i[5]).html(n.memberActivities[t].rate);$(i[6]).html(n.memberActivities[t].earnings)})})};$("#refreshMemberActivityButton").click(function(){t()});t()},h=function(){n.getDashboardData({salesSummaryDatePeriod:t.daily}).done(function(n){r(n.salesSummary,n.totalSales,n.revenue,n.expenses,n.growth);i(n.totalProfit,n.newFeedbacks,n.newOrders,n.newUsers);f(n.dailySales);u(n.transactionPercent,n.newVisitPercent,n.bouncePercent);o(n.profitShares);$(".counterup").counterUp()})};e();s();h()})})();